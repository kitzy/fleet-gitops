- name: Check if PermitRootLogin is disabled
  platform: linux
  description: PermitRootLogin is disabled
  resolution: TODO
  query: SELECT * FROM augeas WHERE path='/etc/ssh/sshd_config' AND label='PermitRootLogin' AND value='no';
  run_script:
      path: ../lib/linux/scripts/baseline-user-ssh.sh
- name: PasswordAuthentication is disabled
  platform: linux
  description: Check if PasswordAuthentication is disabled
  resolution: TODO
  query: SELECT * FROM augeas WHERE path='/etc/ssh/sshd_config' AND label='PasswordAuthentication' AND value='no';
  run_script:
      path: ../lib/linux/scripts/baseline-user-ssh.sh
- name: ChallengeResponseAuthentication is disabled
  platform: linux
  description: Check if ChallengeResponseAuthentication is disabled
  resolution: TODO
  query: SELECT * FROM augeas WHERE path='/etc/ssh/sshd_config' AND label='ChallengeResponseAuthentication' AND value='no';
  run_script:
      path: ../lib/linux/scripts/baseline-user-ssh.sh 
- name: PubkeyAuthentication is enabled
  platform: linux
  description: Check if PubkeyAuthentication is enabled
  resolution: TODO
  query: SELECT * FROM augeas WHERE path='/etc/ssh/sshd_config' AND label='PubkeyAuthentication' AND value='yes';
  run_script:
      path: ../lib/linux/scripts/baseline-user-ssh.sh
- name: SSH user exists
  platform: linux
  description: Check if the specified SSH user exists
  resolution: TODO
  query: SELECT * FROM users WHERE username = 'kitzy';
  run_script:
      path: ../lib/linux/scripts/baseline-user-ssh.sh